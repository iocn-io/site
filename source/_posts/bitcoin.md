---
title: 大白话比特币
tags: []
categories:
  - consensus
  - blockchain
  - bitcoin
date: 2018-06-14 17:30:44
---

# 大白话比特币
## 比特币和区块链
网上的概念和详细解说已经够多了，这里只做一些简要的记录。
比特币是基于分布式帐本记录的数字货币，具有匿名、不可篡改、可验证、去中心化等特点。
区块链源于比特币的实现原理形成的一套理论，包括共识机制、P2P网络、数字签名、Hash等技术和算法。区块链技术在不断发展，基于已知的问题作出大量改进，需要不断的接受新的知识和概念。

## 特点
- 第一款被大众接受并赋予价值的数字货币。
- 去中心化的设计，到矿池的出现已经不存在了。
- 工作量证明死拼算力。
- 算力的评估就是机器每秒能计算多少个Hash（区块头的两遍sha256），CPU/GPU/FPGA/ASIC。
- 挖矿就是成功出块的过程。
- 奖励就是成功出块的结果。
- 没有用户，只有不记名的地址，地址保存一定数量的比特币。
- 交易只是将比特币从一个地址转到N个地址。

## 地址
- 私钥
>绝对的秘密，丢了私钥就相当于丢了比特币。任何人都可以拥有任意数量的私钥，可以把每一个私钥看作是独立的银行帐户，只认密码不认人。

- 地址的构成
>Public Key = Gen(Private Key)
Public Key Hash = base58( ripemd160( sha256( Public Key ) ) )
VerHash = Version(2bits) + Public Key Hash(20bits)
Verify = SubStr( sha256( sha256(地址) ), 4bits)
Addr = VerHash + Verify

## 帐本
- 链条
>一个区块接一个区块的方式构成的链条即帐本，存储在分布式系统中。

- 交易
>描述比特币转移的数据结构，即帐本所记录的内容。一个区块相当于一页帐本记录，每个区块都会记录前一个区块值，形成不可篡改的链条。
一笔交易可以输入多个UTXO，同时输出N个UTXO。无输入且有输出的UTXO是来自系统的挖矿奖励。
交易手续费=输入总额-输出总额。
每个节点收到一笔交易请求验证符合交易条件后广播到网络中。
每个节点收到的交易数据集合可能不一致。
区块大小有限（1M），所以每个区块包含的交易笔数是有限的，提高手续费可以优先记录到帐本中完成交易。

- UTXO
>未使用的交易输出，区块中记录的交易结果，每一笔输出只能被使用一次。
区块中记录某一笔交易的输出地址拥有比特币数量。如果比特币被花费了，在后续的区块中该地址会被作为输入，将资金转移给其他输出地址。
一个地址的余额=所有与该地址关联的UTXO总和。

## 原理

- 出块速度
>比特币设计目标是每十分钟产生一个块，但并不绝对控制，而是每产生2016个块（设计目标约两周）就会自动调节。
出块难度 = 现行难度 * (最近2016块总耗时 / 20160分钟)
出块目标值 = 2^224 / 出块难度

- 挖矿过程
>每个节点将收到的交易纳入自己准备产生的区块中，并生成默克尔树、填充区块头。准备就绪后不停地修改区块头中随机参数再计算区块值，直到区块值小于出块目标值时挖矿成功。
区块值 = sha256( sha256( 区块头( 固定参数, 随机参数 ) ) )

- 分叉
>由于比特币采用工作量证明，两台矿机同时出块的概率虽小，但不是不存在。弱一致性的环境有可能同时产生两个块而出现软分叉。随着时间推移不停地产生新的区块，并接在最长的链条后面，所有节点只承认从创世块起最长的链条，分叉的链条将不被承认。

- 工作量证明
>即常说的PoW共识机制，原理自行脑补（看懂出块速度和挖矿过程就不难理解了），优势就是可以独立完成，不需要与其他节点进行交流来达成共识。

- 2100万
>比特币是如何限制总数2100万个的呢？其实原理很简单：
最开始产生一个块获得50个比特币的奖励，但是每产生21万个块（设计目标约四年）后系统将奖励减半，也就是常说的减产。

## 自行脑补
- 双花
- 51%攻击
- 创世区块
- 交易验证/SPV
- 轻节点
- 高度
- 区块头结构
- 默克尔树
- ECC
- 悄悄地告诉你，数据传输时的加密操作有点意思哦